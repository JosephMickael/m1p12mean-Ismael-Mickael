<div class="container-fluid p-0">
    <div class="row g-0">
        <!-- Sidebar (fond gris) -->
        <nav class="sidebar" [ngClass]="{'collapsed': isSidebarCollapsed}"
            style="background-color: #34495E; color: white;">
            <div class="pt-3">
                <h3 class="px-3" [ngClass]="{'d-none': isSidebarCollapsed}">GARAGE</h3>
                <div class="d-flex justify-content-center" *ngIf="isSidebarCollapsed">
                    <h3 class="m-0 p-0">G</h3>
                </div>


                <div class="menu-items" [ngClass]="{'d-none': isSidebarCollapsed}">
                    <ul class="nav flex-column mt-4">
                        <li class="nav-item">
                            <a class="nav-link text-white d-flex align-items-center"
                                [routerLink]="['/manager-page/acceuil']" routerLinkActive="active">
                                <i class="bi bi-house me-2"></i>
                                <span>Acceuil</span>
                            </a>
                        </li>
                        <!-- Fonctionnel -->
                        <li class="nav-item">
                            <a class="nav-link text-white d-flex align-items-center"
                                [routerLink]="['/manager-page/utilisateurs']" routerLinkActive="active">
                                <i class="bi bi-people me-2"></i>
                                <span>Utilisateurs</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white d-flex align-items-center"
                                [routerLink]="['/manager-page/rendez-vous']" routerLinkActive="active">
                                <i class="bi bi-calendar-range me-2"></i>
                                <span>Rendez-vous</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white d-flex align-items-center"
                                [routerLink]="['/manager-page/devis']" routerLinkActive="active">
                                <i class="bi bi-journals me-2"></i>
                                <span>Devis</span>
                            </a>
                        </li>
                        <li class="nav-item w-100" style="position: absolute; bottom: 5px;">
                            <a class="nav-link text-white d-flex align-items-center" (click)="logout()"
                                style="cursor: pointer;">
                                <i class="bi bi-box-arrow-right me-2"></i>
                                <span>Déconnexion</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- Version icônes pour sidebar repliée -->
                <div class="icon-menu" *ngIf="isSidebarCollapsed">
                    <ul class="nav flex-column mt-4">
                        <li class="nav-item">
                            <a class="nav-link text-white d-flex justify-content-center"
                                [routerLink]="['/manager-page/acceuil']" routerLinkActive="active">
                                <i class="bi bi-house"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white d-flex justify-content-center"
                                routerLink="/manager-page/utilisateurs" routerLinkActive="active">
                                <i class="bi bi-people"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white d-flex justify-content-center"
                                [routerLink]="['/manager-page/rendez-vous']" routerLinkActive="active">
                                <i class="bi bi-calendar-range"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white d-flex justify-content-center"
                                [routerLink]="['/manager-page/devis']" routerLinkActive="active">
                                <i class="bi bi-journals"></i>
                            </a>
                        </li>
                        <li class="nav-item w-100" style="position: absolute; bottom: 5px;">
                            <a class="nav-link text-white text-center d-flex justify-content-center" (click)="logout()"
                                style="cursor: pointer;">
                                <i class="bi bi-box-arrow-right"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

        </nav>

        <!-- Partie gauche -->
        <main style="background-color: white; min-height: 100vh;">
            <!-- Barre de profil en haut à droite -->
            <div class="nav-main d-flex align-items-center p-3">
                <i class="bi" (click)="toggleSidebar()" [ngClass]="isSidebarCollapsed ? 'bi-layout-sidebar' : 'bi-x-lg'"
                    style="cursor: pointer;"></i>
                <div class="d-flex align-items-center ms-3">
                    <h4 *ngIf="rlprofil.isActive" class="fw-bold m-0">Profil Utilisateur</h4>
                </div>
                <div class="d-flex justify-content-end ms-auto">
                    <!-- Messages -->
                    <a class="nav-link d-flex align-items-center me-3 fs-4" [routerLink]="['/manager-page/messages']"
                        routerLinkActive="active" title="Vos messages">
                        <span class="bi bi-envelope me-2 position-relative">
                            <span *ngIf="unreadCount > 0"
                                class="position-absolute start-100 translate-middle badge rounded-pill bg-danger px-1 py-0 small"
                                style="top: 5px; font-size: 15px;">
                                {{ unreadCount }}
                                <span class="visually-hidden">Messages non lus</span>
                            </span>
                        </span>
                    </a>

                    <div class="dropdown">
                        <a class="d-flex align-items-center text-decoration-none dropdown-toggle text-dark" href="#"
                            id="dropdownProfile" data-bs-toggle="dropdown" aria-expanded="false">
                            <span class="rounded-circle bg-light d-flex align-items-center justify-content-center me-2"
                                style="width: 40px; height: 40px;">
                                <i class="bi bi-person-fill"></i>
                            </span>
                            <span>{{ user.nom }}</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownProfile"
                            style="cursor: pointer;">
                            <li>
                                <a class="dropdown-item" [routerLink]="['/manager-page/profil']"
                                    routerLinkActive="active" #rlprofil="routerLinkActive">
                                    <i class="bi bi-person me-2"></i>
                                    Profil
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item" (click)="logout()">
                                    <i class="bi bi-box-arrow-right me-2"></i>
                                    Déconnexion
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Contenu principal avec router-outlet -->
            <div class="container">
                <router-outlet></router-outlet>
            </div>
        </main>
    </div>
</div>